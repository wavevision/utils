os: linux
dist: xenial
language: php

php:
  - 7.2

git:
  depth: 1

before_script:
  - composer install

jobs:
  include:
    - stage: ParallelLint
      script: composer phing lint
    - stage: CodeSniffer
      script: composer phing phpcs
    - stage: PHPStan
      script: composer phing phpstan
    - stage: Test
      install:
        - wget https://github.com/php-coveralls/php-coveralls/releases/download/v2.1.0/php-coveralls.phar
      script:
        - composer phing test:coverage
        - php php-coveralls.phar --verbose --config .coveralls.yml

cache:
  directories:
    - $HOME/.composer/cache
